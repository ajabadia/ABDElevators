[dotenv@17.2.3] injecting env (18) from .env.local -- tip: ÔÜÖ´©Å  override existing env vars with { override: true }
­ƒöì Hunting for documents with tenantId: default_tenant...
Ô£à FOUND potential docs in ABDElevators.workflow_definitions (Count: 2)
Sample: {
  "_id": "6981930bf2c0a75fc0a52a18",
  "name": "Test Connectivity Flow",
  "tenantId": "test_tenant",
  "createdAt": "2026-02-03T06:17:47.037Z"
}
---
Ô£à FOUND potential docs in ABDElevators.ai_workflows (Count: 1)
Sample: {
  "_id": "69807fcee8da2e645fc38391",
  "name": "E2E Test Workflow",
  "active": true,
  "trigger": {
    "type": "on_entity_change",
    "condition": {
      "field": "riskScore",
      "operator": "lt",
      "value": 50
    }
  },
  "actions": [
    {
      "type": "log",
      "params": {
        "message": "Executed Log Incident to DB"
      }
    }
  ],
  "tenantId": "test-tenant-e2e",
  "id": "408bd7a2-4e8c-43ff-9319-282f350b4b8c",
  "visual": {
    "nodes": [
      {
        "id": "node-1",
        "type": "trigger",
        "data": {
          "label": "Risk Score"
        },
        "position": {
          "x": 0,
          "y": 0
        }
      },
      {
        "id": "node-2",
        "type": "condition",
        "data": {
          "label": "Score < 50"
        },
        "position": {
          "x": 200,
          "y": 0
        }
      },
      {
        "id": "node-3",
        "type": "action",
        "data": {
          "label": "Log Incident to DB"
        },
        "position": {
          "x": 400,
          "y": 0
        }
      }
    ],
    "edges": [
      {
        "id": "e1-2",
        "source": "node-1",
        "target": "node-2"
      },
      {
        "id": "e2-3",
        "source": "node-2",
        "target": "node-3"
      }
    ]
  },
  "createdAt": "2026-02-02T10:43:26.858Z",
  "createdBy": "admin@test.com",
  "updatedAt": "2026-02-02T10:43:26.858Z"
}
---
Ô£à FOUND potential docs in ABDElevators.notifications (Count: 3)
Sample: {
  "_id": "69733eaa8022af6980bd55cf",
  "tenantId": "default_tenant",
  "usuarioId": "6971d06b2375be77e344beae",
  "tipo": "WORKFLOW",
  "prioridad": "HIGH",
  "titulo": "Nuevo Pedido Asignado",
  "mensaje": "El pedido #ABC-999 se ha movido al estado \"analizado\" y requiere tu validaci├│n.",
  "link": "/pedidos/6971d06b2375be77e344beae/validar",
  "leido": false,
  "creado": "2026-01-23T09:26:02.435Z"
}
---
Ô£à FOUND potential docs in ABDElevators.workflow_configs (Count: 1)
Sample: {
  "_id": "697213c2c91d0686a872eb6b",
  "tenantId": "default_tenant",
  "caseType": "MAINTENANCE",
  "industry": "ELEVATORS",
  "active": true,
  "creado": "2026-01-22T12:18:32.783Z",
  "states": [
    {
      "id": "PENDING",
      "label": "Pendiente",
      "color": "slate",
      "is_initial": true
    },
    {
      "id": "ANALYZED",
      "label": "Analizado",
      "color": "teal",
      "icon": "zap"
    },
    {
      "id": "VALIDATED",
      "label": "Validado",
      "color": "blue",
      "icon": "check-circle"
    },
    {
      "id": "COMPLETED",
      "label": "Finalizado",
      "color": "green",
      "is_final": true
    }
  ],
  "transitions": [
    {
      "from": "PENDING",
      "to": "ANALYZED",
      "label": "Analizar",
      "action": "ANALYZE",
      "roles": [
        "TECNICO",
        "ADMIN"
      ]
    },
    {
      "from": "ANALYZED",
      "to": "VALIDATED",
      "label": "Validar Checklists",
      "action": "VALIDATE",
      "roles": [
        "TECNICO",
        "ADMIN"
      ]
    },
    {
      "from": "VALIDATED",
      "to": "COMPLETED",
      "label": "Cerrar Caso",
      "action": "FINALIZE",
      "roles": [
        "ADMIN"
      ],
      "require_signature": true
    }
  ]
}
---
Ô£à FOUND potential docs in ABDElevators.prompt_versions (Count: 32)
Sample: {
  "_id": "6977d3332b75d7d1c6389511",
  "promptId": "6977190c64ba197f047494bc",
  "tenantId": "default_tenant",
  "version": 1,
  "template": "Analiza este documento de pedido de ascensores y extrae una lista JSON con todos los modelos de componentes mencionados. \nFormato: [{ \"tipo\": \"botonera\" | \"motor\" | \"cuadro\" | \"puerta\" | \"otros\", \"modelo\": \"C├ôDIGO\" }]. \nSolo devuelve el JSON, sin explicaciones.\n\nTEXTO:\n{{text}}",
  "variables": [
    {
      "name": "text",
      "type": "string",
      "description": "Texto del documento a analizar",
      "required": true
    }
  ],
  "changedBy": "system-seed",
  "changeReason": "Actualizaci├│n autom├ítica v├¡a Seed Script (Core Update)",
  "createdAt": "2026-01-26T20:48:51.861Z"
}
---
Ô£à FOUND potential docs in ABDElevators.rag_evaluations (Count: 4)
Sample: {
  "_id": "69785bcb2cf0c82223bf1c0a",
  "tenantId": "default_tenant",
  "correlacion_id": "84c6e07b-014c-49cf-9cea-717a548bd1fc",
  "query": "┬┐C├│mo configuro el operador de puertas Quantum?",
  "generation": "Para configurar el operador Quantum, debe ajustar el potenci├│metro P1 para la velocidad de cierre y P2 para la apertura. Verifique el LED de estado.",
  "context_chunks": [
    "Manual Quantum P1/P2 config",
    "LED diagnostics Quantum"
  ],
  "metrics": {
    "faithfulness": 1,
    "answer_relevance": 0.95,
    "context_precision": 1
  },
  "judge_model": "gemini-1.5-flash",
  "timestamp": "2026-01-27T05:31:39.104Z"
}
---
Ô£à FOUND potential docs in ABDElevators.usage_logs (Count: 1143)
Sample: {
  "_id": "6978547f7747158c327b35b1",
  "tenantId": "default_tenant",
  "tipo": "VECTOR_SEARCH",
  "valor": 1,
  "recurso": "mongodb-vector-search",
  "descripcion": "Consulta de b├║squeda sem├íntica realizada",
  "correlacion_id": "550e8400-e29b-41d4-a716-446655440000",
  "timestamp": "2026-01-27T06:00:31.727Z"
}
---
Ô£à FOUND potential docs in ABDElevators.taxonomias (Count: 3)
Sample: {
  "_id": "69721bb9c91d0686a872ed4d",
  "tenantId": "default_tenant",
  "industry": "ELEVATORS",
  "key": "geography",
  "active": true,
  "creado": "2026-01-22T12:48:41.739Z",
  "description": "Regionalizaci├│n de los activos",
  "multiple": false,
  "name": "Ubicaci├│n Geogr├ífica",
  "options": [
    {
      "id": "north",
      "label": "Zona Norte",
      "color": "blue"
    },
    {
      "id": "south",
      "label": "Zona Sur",
      "color": "emerald"
    },
    {
      "id": "center",
      "label": "Zona Centro",
      "color": "amber"
    },
    {
      "id": "east",
      "label": "Levante",
      "color": "orange"
    }
  ],
  "required": true
}
---
Ô£à FOUND potential docs in ABDElevators.prompts (Count: 16)
Sample: {
  "_id": "6977190c64ba197f047494bb",
  "tenantId": "default_tenant",
  "key": "RISK_AUDITOR",
  "name": "Auditor de Riesgos",
  "description": "Analiza casos en busca de riesgos t├®cnicos, legales o de seguridad",
  "category": "RISK",
  "template": "Act├║a como un Auditor de Riesgos experto en la industria de {{industry}}.\nTu tarea es analizar el CONTENIDO DEL CASO compar├índolo con el CONTEXTO DE NORMATIVA/MANUALES extra├¡do del RAG.\n\nCONTENIDO DEL CASO:\n{{caseContent}}\n\nCONTEXTO RAG (Normas, Seguridad, Precedentes):\n{{ragContext}}\n\nINSTRUCCIONES:\n1. Identifica incompatibilidades t├®cnicas, violaciones de seguridad, riesgos legales o desviaciones de normativa.\n2. Si no hay riesgos claros, devuelve un array vac├¡o.\n3. Formato de salida: Un array JSON de objetos con:\n   - \"id\": string corto (ej: \"R-001\")\n   - \"tipo\": \"SEGURIDAD\" | \"COMPATIBILIDAD\" | \"LEGAL\" | \"NORMATIVA\" | \"GENERAL\"\n   - \"severidad\": \"LOW\" | \"MEDIUM\" | \"HIGH\" | \"CRITICAL\"\n   - \"mensaje\": Descripci├│n detallada del riesgo detectado.\n   - \"referencia_rag\": Cita breve de qu├® parte del manual o norma justifica este riesgo.\n   - \"sugerencia\": Acci├│n recomendada para mitigar el riesgo.\n\nResponde ├ÜNICAMENTE con el array JSON.",
  "variables": [
    {
      "name": "industry",
      "type": "string",
      "description": "Industria del tenant",
      "required": true
    },
    {
      "name": "caseContent",
      "type": "string",
      "description": "Contenido del caso a analizar",
      "required": true
    },
    {
      "name": "ragContext",
      "type": "string",
      "description": "Contexto extra├¡do del RAG",
      "required": true
    }
  ],
  "version": 4,
  "active": true,
  "createdBy": "system",
  "createdAt": "2026-01-26T20:48:51.769Z",
  "updatedBy": "system",
  "updatedAt": "2026-02-01T20:49:43.605Z",
  "model": "gemini-1.5-flash",
  "creado": "2026-01-28T14:03:05.632Z"
}
---
